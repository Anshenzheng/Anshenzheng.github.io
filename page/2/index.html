<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.6" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.0.6">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.0.6">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.0.6">


  <link rel="mask-icon" href="/images/logo.svg?v=6.0.6" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.0.6',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="千里之行, 始于足下">
<meta property="og:type" content="website">
<meta property="og:title" content="知乐园">
<meta property="og:url" content="https://anshenzheng.github.io/page/2/index.html">
<meta property="og:site_name" content="知乐园">
<meta property="og:description" content="千里之行, 始于足下">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="知乐园">
<meta name="twitter:description" content="千里之行, 始于足下">



  <link rel="alternate" href="/atom.xml" title="知乐园" type="application/atom+xml" />




  <link rel="canonical" href="https://anshenzheng.github.io/page/2/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>知乐园</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> 

<div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">知乐园</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
          
  <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-futbol-o"></i> <br />关于</a>
</li>

      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  
    

    
    
      
      
    
      
      
    
      
      
    
      
      
    
      
      
    
    

  


  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://anshenzheng.github.io/2017/07/10/Javascript中的闭包/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Annan An">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知乐园">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/10/Javascript中的闭包/" itemprop="url">Javascript中的闭包</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-10T22:02:49+08:00">2017-07-10</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/前端/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/07/10/Javascript中的闭包/" class="leancloud_visitors" data-flag-title="Javascript中的闭包">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><h3 id="什么是闭包"><a href="#什么是闭包" class="headerlink" title="什么是闭包"></a>什么是闭包</h3><p>闭包(closure)是指在JavaScript中，将外部函数中的局部变量封闭起来的(内部)函数。<br>(被封闭起来的变量与封闭它的函数具有相同的生命周期。)</p>
<p>示例如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> local = <span class="string">"local variable"</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">var</span> inner = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="built_in">console</span>.log(local);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> inner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>示例中内部函数inner持有外部函数func的局部变量local，这样就构成了一个作用域(闭包)，通过该作用域我们可以访问及修改外部访问不到的内部变量。</p>
<h3 id="闭包的作用"><a href="#闭包的作用" class="headerlink" title="闭包的作用"></a>闭包的作用</h3><p>管理私有变量和私有方法，将对变量的管理封装在安全环境之中。<br>外层函数执行之后，它的局部变量本来应该全部销毁，但是由于闭包的存在，之后执行内部函数，通过它仍然可以访问到外层函数的变量。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> name = <span class="string">"Charlie"</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> &#123;</span><br><span class="line">		setName: <span class="function"><span class="keyword">function</span>(<span class="params">new_name</span>)</span>&#123;</span><br><span class="line">			name = new_name;</span><br><span class="line">		&#125;,</span><br><span class="line">		getName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			<span class="keyword">return</span> name;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> f = func();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(f.name);</span><br><span class="line"><span class="comment">// 打印结果：</span></span><br><span class="line"><span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(f.getName())</span><br><span class="line"><span class="comment">// 打印结果：</span></span><br><span class="line"><span class="comment">// Charlie</span></span><br><span class="line"></span><br><span class="line">f.setName(<span class="string">"Teddy"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(f.getName())</span><br><span class="line"><span class="comment">// 打印结果：</span></span><br><span class="line"><span class="comment">// Teddy</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://anshenzheng.github.io/2017/07/10/Cache相关的HTTP请求响应头/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Annan An">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知乐园">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/10/Cache相关的HTTP请求响应头/" itemprop="url">Cache相关的HTTP请求/响应头</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-10T22:02:49+08:00">2017-07-10</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/前端/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/07/10/Cache相关的HTTP请求响应头/" class="leancloud_visitors" data-flag-title="Cache相关的HTTP请求/响应头">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><p>常见的HTTP请求/响应头有很多，以下介绍几种cache相关的：</p>
<ul>
<li>Pragma</li>
<li>Cache-Control</li>
<li>Expires</li>
<li>Last-Modified</li>
<li>Etag</li>
</ul>
<h3 id="Pragma-amp-Cache-Control"><a href="#Pragma-amp-Cache-Control" class="headerlink" title="Pragma &amp; Cache-Control"></a>Pragma &amp; Cache-Control</h3><p>用于指定所有缓存机制在整个请求/响应链中必须服从的命令，如果知道该页面是否为缓存，不仅可以控制浏览器，还可以控制HTTP协议相关的缓存或者代理服务器。</p>
<p>Cache-Control请求字段优先级比较高，如果和其它一些相冲突的字段(比如Expires)同时出现，则Cache-Control会覆盖其它字段。<br>Pragma的作用和Cache-Control类似，也是在HTTP头中包含一个特殊指令，使相关的服务器来遵守，Pragma:no-cache 和 Cache-Control:no-cache的作用是一样的。</p>
<blockquote>
<p>浏览器中的强制刷新(Ctrl + F5)就是通过发起请求时加上请求头 Pragma:no-cache 和 Cache-Control:no-cache 实现的。</p>
</blockquote>
<h3 id="Expires"><a href="#Expires" class="headerlink" title="Expires"></a>Expires</h3><p>通常格式为Expires:Sat,25Feb201712:22:17GMT,后面跟着日期和时间，超过这个时间值后，缓存内容将失效，也就是浏览器在发出请求之前会检查这个页面的字段，如果页面已经过期，就重新向服务器发起请求。</p>
<h3 id="Last-Modified-amp-Etag"><a href="#Last-Modified-amp-Etag" class="headerlink" title="Last-Modified &amp; Etag"></a>Last-Modified &amp; Etag</h3><p>Last-Modified一般用于表示一个服务器上的资源的最后修改时间，资源可以是静态或者是动态的。<br>一般服务端在响应头中返回一个Last-Modified字段，告诉浏览器这个页面的最后修改时间，浏览器再次请求时在请求头中增加一个If-Modified-Since:Sat,25Feb201712:22:17GMT,询问当前缓存的页面是否是最新的，如果是最新的就返回304，告诉浏览器是最新的，服务器也不会传输新的数据。</p>
<p>Etag与Last-Modified功能类似，作用是让服务器给每个页面分配一个唯一的编号，然后通过编号来区分当前页面是否为最新。这种方式比Last-Modified更灵活，但是在后端的Web服务器有多台时就比较难处理，因为每个web服务器都要记住网站的所有资源，否则这个编号就没有意义了。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://anshenzheng.github.io/2017/07/09/Javascript中的Prototype/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Annan An">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知乐园">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/09/Javascript中的Prototype/" itemprop="url">Javascript中的Prototype</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-09T22:11:25+08:00">2017-07-09</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/前端/" itemprop="url" rel="index"><span itemprop="name">前端</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/07/09/Javascript中的Prototype/" class="leancloud_visitors" data-flag-title="Javascript中的Prototype">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><h3 id="Prototype-是什么"><a href="#Prototype-是什么" class="headerlink" title="Prototype 是什么"></a>Prototype 是什么</h3><p>Javascript中，prototype是函数的一个属性，它本身是一个对象，而这个对象的构造函数指向函数本身。<br>描述比较抽象，但是通过以下代码就很容易理解：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ff</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"this is function ff"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(ff.prototype.constructor == ff);</span><br><span class="line"><span class="comment">// 打印结果：</span></span><br><span class="line"><span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>由上也不难推出以下几个特殊对象的prototype：</p>
<ul>
<li>Array.prototype 是一个数组</li>
<li>String.prototype 是一个字符串</li>
<li>Object.prototype 是一个对象</li>
</ul>
</blockquote>
<p>需要注意的是，prototype属性只能用于函数，如果引用某个具体对象的prototye属性，则其为undefined。</p>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ff</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"this is function ff"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(ff.prototype); </span><br><span class="line"><span class="comment">//打印结果：</span></span><br><span class="line"><span class="comment">// [object Object]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(ff.prototype)); </span><br><span class="line"><span class="comment">//打印结果:</span></span><br><span class="line"><span class="comment">// &#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> <span class="built_in">Object</span>().prototype)</span><br><span class="line"><span class="comment">//打印结果:</span></span><br><span class="line"><span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> ff().prototype)</span><br><span class="line"><span class="comment">//打印结果:</span></span><br><span class="line"><span class="comment">// 猜猜看是什么 :)</span></span><br></pre></td></tr></table></figure>
<h3 id="Prototype-有什么用"><a href="#Prototype-有什么用" class="headerlink" title="Prototype 有什么用"></a>Prototype 有什么用</h3><p>通过prototype可以为函数对象添加新的属性和方法, 所有通过 new 方法实现函数对象都会拥有新添加的方法和属性，相当于间接实现了继承。</p>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">animal</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">animal.prototype.type = <span class="string">"animal"</span>;</span><br><span class="line">animal.prototype.sayHi = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Hi, I am "</span> + <span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cat = <span class="keyword">new</span> animal(<span class="string">'cat'</span>);</span><br><span class="line"><span class="keyword">var</span> dog = <span class="keyword">new</span> animal(<span class="string">'dog'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(cat.type);</span><br><span class="line"><span class="built_in">console</span>.log(cat.name);</span><br><span class="line"><span class="comment">//打印结果:</span></span><br><span class="line"><span class="comment">// animal</span></span><br><span class="line"><span class="comment">// cat</span></span><br><span class="line"><span class="built_in">console</span>.log(dog.type);</span><br><span class="line"><span class="built_in">console</span>.log(dog.name);</span><br><span class="line"><span class="comment">//打印结果:</span></span><br><span class="line"><span class="comment">// animal</span></span><br><span class="line"><span class="comment">// dog</span></span><br><span class="line"></span><br><span class="line">cat.sayHi();</span><br><span class="line"><span class="comment">//打印结果:</span></span><br><span class="line"><span class="comment">// Hi, I am cat</span></span><br><span class="line">dog.sayHi();</span><br><span class="line"><span class="comment">//打印结果:</span></span><br><span class="line"><span class="comment">// Hi, I am dog</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://anshenzheng.github.io/2017/07/08/高数常用定理及使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Annan An">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知乐园">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/08/高数常用定理及使用/" itemprop="url">高数常用定理及使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-08T13:37:44+08:00">2017-07-08</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/考研/" itemprop="url" rel="index"><span itemprop="name">考研</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/07/08/高数常用定理及使用/" class="leancloud_visitors" data-flag-title="高数常用定理及使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><h3 id="有界性定理"><a href="#有界性定理" class="headerlink" title="有界性定理"></a>有界性定理</h3><p>要求：只用不证<br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E6%9C%89%E7%95%8C%E6%80%A7%E5%AE%9A%E7%90%86.png?raw=true" alt=""></p>
<h3 id="最值定理"><a href="#最值定理" class="headerlink" title="最值定理"></a>最值定理</h3><p>要求：只用不证<br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E6%9C%80%E5%80%BC%E5%AE%9A%E7%90%86.png?raw=true" alt=""></p>
<h3 id="介值定理"><a href="#介值定理" class="headerlink" title="介值定理"></a>介值定理</h3><p>要求：只用不证<br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E4%BB%8B%E5%80%BC%E5%AE%9A%E7%90%861.png?raw=true" alt=""><br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E4%BB%8B%E5%80%BC%E5%AE%9A%E7%90%862.png?raw=true" alt=""></p>
<h3 id="积分中值定理"><a href="#积分中值定理" class="headerlink" title="积分中值定理"></a>积分中值定理</h3><p><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E7%A7%AF%E5%88%86%E4%B8%AD%E5%80%BC%E5%AE%9A%E7%90%86.png?raw=true" alt=""></p>
<h3 id="积分保号定理"><a href="#积分保号定理" class="headerlink" title="积分保号定理"></a>积分保号定理</h3><p><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E7%A7%AF%E5%88%86%E4%BF%9D%E5%8F%B7%E6%80%A7%E5%AE%9A%E7%90%86.png?raw=true" alt=""></p>
<h3 id="零点定理"><a href="#零点定理" class="headerlink" title="零点定理"></a>零点定理</h3><p>要求：只用不证<br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E9%9B%B6%E7%82%B9%E5%AE%9A%E7%90%86.png?raw=true" alt=""></p>
<h3 id="费马定理"><a href="#费马定理" class="headerlink" title="费马定理"></a>费马定理</h3><p>要求：会用会证<br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E8%B4%B9%E9%A9%AC%E5%AE%9A%E7%90%86.png?raw=true" alt=""></p>
<h3 id="罗尔定理"><a href="#罗尔定理" class="headerlink" title="罗尔定理"></a>罗尔定理</h3><p>要求：会用会证（最重要）<br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E7%BD%97%E5%B0%94%E5%AE%9A%E7%90%86%E4%BD%BF%E7%94%A81.png?raw=true" alt=""><br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E7%BD%97%E5%B0%94%E5%AE%9A%E7%90%86%E4%BD%BF%E7%94%A82.png?raw=true" alt=""><br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E7%BD%97%E5%B0%94%E5%AE%9A%E7%90%86%E4%BD%BF%E7%94%A83.png?raw=true" alt=""><br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E7%BD%97%E5%B0%94%E5%AE%9A%E7%90%86%E4%BD%BF%E7%94%A84.png?raw=true" alt=""><br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E7%BD%97%E5%B0%94%E5%AE%9A%E7%90%86%E4%BD%BF%E7%94%A85.png?raw=true" alt=""></p>
<p>若题设条件“=”较多，则优先考虑使用罗尔定理。</p>
<h3 id="拉格朗日定理"><a href="#拉格朗日定理" class="headerlink" title="拉格朗日定理"></a>拉格朗日定理</h3><p><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E4%B8%AD%E5%80%BC%E5%AE%9A%E7%90%86.png?raw=true" alt=""><br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E4%B8%AD%E5%80%BC%E5%AE%9A%E7%90%862.png?raw=true" alt=""></p>
<h3 id="柯西中值定理"><a href="#柯西中值定理" class="headerlink" title="柯西中值定理"></a>柯西中值定理</h3><p>要求：会用会证<br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E6%9F%AF%E8%A5%BF%E5%AE%9A%E7%90%861.png?raw=true" alt=""><br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E6%9F%AF%E8%A5%BF%E5%AE%9A%E7%90%862.png?raw=true" alt=""></p>
<h3 id="泰勒定理（公式）"><a href="#泰勒定理（公式）" class="headerlink" title="泰勒定理（公式）"></a>泰勒定理（公式）</h3><p>要求：只用不证</p>
<h4 id="带拉格朗日余项的公式"><a href="#带拉格朗日余项的公式" class="headerlink" title="带拉格朗日余项的公式"></a>带拉格朗日余项的公式</h4><p><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E6%B3%B0%E5%8B%92%E5%85%AC%E5%BC%8F1.png?raw=true" alt=""><br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E6%B3%B0%E5%8B%92%E5%85%AC%E5%BC%8F2.png?raw=true" alt=""></p>
<h4 id="带佩亚诺余项的公式"><a href="#带佩亚诺余项的公式" class="headerlink" title="带佩亚诺余项的公式"></a>带佩亚诺余项的公式</h4><p><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E4%BD%A9%E4%BA%9A%E8%AF%BA.png?raw=true" alt=""></p>
<h4 id="麦克劳林公式（0点展开）"><a href="#麦克劳林公式（0点展开）" class="headerlink" title="麦克劳林公式（0点展开）"></a>麦克劳林公式（0点展开）</h4><p><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E9%BA%A6%E5%85%8B%E5%8A%B3%E6%9E%97.png?raw=true" alt=""><br><img src="https://github.com/Anshenzheng/kao-yan-bi-ji/blob/master/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/%E9%BA%A6%E5%85%8B%E5%8A%B3%E6%9E%972.png?raw=true" alt=""></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://anshenzheng.github.io/2017/07/07/MySQL中的日志文件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Annan An">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知乐园">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/07/MySQL中的日志文件/" itemprop="url">MySQL中的日志文件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-07T18:08:58+08:00">2017-07-07</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/数据库/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/07/07/MySQL中的日志文件/" class="leancloud_visitors" data-flag-title="MySQL中的日志文件">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><p>日志文件是数据库中非常重要的文件，可以用于操作查询，性能分析，事务保障以及数据恢复等。MySQL中的常见日志文件如下：</p>
<h3 id="错误日志：Error-Log"><a href="#错误日志：Error-Log" class="headerlink" title="错误日志：Error Log"></a>错误日志：Error Log</h3><p>错误日志记录了MySQL运行过程中所有较为严重的警告和错误信息，以及每次启动和关闭的详细信息。<br>默认情况下，错误记录日志功能是关闭的，错误信息会被输出到标准错误输出stderr。我们可以在启动时开启<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--log-error</span><br></pre></td></tr></table></figure></p>
<p>选项开启错入日志功能。<br>错误日志默认以hostname.err命名存放于数据目录下， 但是可以使用命令:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">log-error[=file_name]</span><br></pre></td></tr></table></figure></p>
<p>来修改存放的目录和文件名。</p>
<h3 id="二进制日志：Binary-Log-amp-Binary-Log-Index"><a href="#二进制日志：Binary-Log-amp-Binary-Log-Index" class="headerlink" title="二进制日志：Binary Log &amp; Binary Log Index"></a>二进制日志：Binary Log &amp; Binary Log Index</h3><p>二进制日志是MySQL中最重要的日志之一，通过：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--log-bin[=file_name]</span><br></pre></td></tr></table></figure></p>
<p>开启，MySQL会将所有修改数据库的Query(Query语句，执行时间，消耗资源，相关事务信息等)以二进制的形式记录于该日志文件。</p>
<p>以下是binlog的一些附加选项参数：<br>–max_binlog_size - binlog的最大存储上限，当日志达到该上限时，会自动创建一个新日志。为了保证事务安全，MySQL不会将同一个事务分开记录到两个binlog中，故有时会超出最大上限。<br>–binlog-do-db=db_name - 指明仅对db_name数据库记录binlog，忽略其它数据库执行的Query(db_name指当前正在连接的数据库)<br>–binlog-ignore-db=db_name - 功能与–binlog-do-db相反 (db_name指当前正在连接的数据库)<br>mysql-bin.index - 记录所有Binary Log的绝对路径，保证MySQL线程可以顺利的找到所需要的log文件。</p>
<h3 id="更新日志-Update-Log"><a href="#更新日志-Update-Log" class="headerlink" title="更新日志: Update Log"></a>更新日志: Update Log</h3><p>更新日志是MySQL在较老版本上使用的，功能与bin-log类似，以简单的文本格式记录，MySQL5.0之后不再支持。</p>
<h3 id="查询日志-Query-Log"><a href="#查询日志-Query-Log" class="headerlink" title="查询日志: Query Log"></a>查询日志: Query Log</h3><p>查询日志记录MySQL中所有的Query，可以通过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--log[=file_name]</span><br></pre></td></tr></table></figure></p>
<p>来开启日志。<br>由于记录了所有的Query，包括所有的Select语句，故体积比较大，开启后对性能影响也比较大。默认文件名为数据目录下的hostname.log.</p>
<h3 id="慢查询日志：Slow-Query-Log"><a href="#慢查询日志：Slow-Query-Log" class="headerlink" title="慢查询日志：Slow Query Log"></a>慢查询日志：Slow Query Log</h3><p>用于记录执行时间较长的Query，通过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--log-slow-queries[=file_name]</span><br></pre></td></tr></table></figure></p>
<p>开启，默认文件名为数据目录下的hostname-slow.log。<br>慢查询日志采用简单文本格式，记录了语句执行的时刻，消耗的时间，执行的用户以及连接主机等相关的信息。MySQL还提供了mysqlslowdump工具程序专门用来分析慢查询日志，帮助数据库管理人员解决可能存在的性能问题。</p>
<h3 id="InnoDB在线Redo日志：InnoDB-REDO-Log"><a href="#InnoDB在线Redo日志：InnoDB-REDO-Log" class="headerlink" title="InnoDB在线Redo日志：InnoDB REDO Log"></a>InnoDB在线Redo日志：InnoDB REDO Log</h3><p>InnoDB是一个事务安全的存储引擎，其安全性主要是通过REDO日志和记录在表空间的UNDO信息来保证的。<br>REDO日志中记录了InnoDB所做的所有物理变更和事务信息，默认存放于数据目录下，可以通过innodb_log_group_home_dir来更改日志存放位置，通过innodb_log_files_in_group设置日志数量。</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://anshenzheng.github.io/2017/02/15/Spring-AOP的实现机制/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Annan An">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知乐园">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/02/15/Spring-AOP的实现机制/" itemprop="url">Spring AOP的实现机制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-15T13:14:22+08:00">2017-02-15</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/后端/" itemprop="url" rel="index"><span itemprop="name">后端</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/02/15/Spring-AOP的实现机制/" class="leancloud_visitors" data-flag-title="Spring AOP的实现机制">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>AOP（Aspect Orient Programming），一般称为面向切面编程，作为面向对象的一种补充，用于处理系统中分布于各个模块的横切关注点，比如事务管理、日志、缓存等等。AOP实现的关键在于AOP框架自动创建的AOP代理，AOP代理主要分为静态代理和动态代理，静态代理的代表为AspectJ；而动态代理则以Spring AOP为代表。静态代理是编译期实现，动态代理是运行期实现，可想而知前者拥有更好的性能。本文主要介绍Spring AOP的两种代理实现机制，JDK动态代理和CGLIB动态代理。</p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/02/15/Spring-AOP的实现机制/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://anshenzheng.github.io/2016/07/16/Java-NIO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Annan An">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知乐园">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/07/16/Java-NIO/" itemprop="url">Java NIO</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-07-16T22:51:43+08:00">2016-07-16</time>
            

            
            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/07/16/Java-NIO/" class="leancloud_visitors" data-flag-title="Java NIO">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><h3 id="NIO模型原理"><a href="#NIO模型原理" class="headerlink" title="NIO模型原理"></a>NIO模型原理</h3><p>Channel: Channel是一个在TCP连接之间的抽象，一个TCP链接可以对应多个管道，而不是以前的方式只有一个通信信道，减少了TCP连接次数。</p>
<p>UDP：采用相同方式，也是抽象为管道。</p>
<p>通过selector(选择器)，相当于管家，管理所有的IO事件(Connection/accept，客户端服务端的读写等)。</p>
<h4 id="Selector管理IO事件"><a href="#Selector管理IO事件" class="headerlink" title="Selector管理IO事件"></a>Selector管理IO事件</h4><p>当IO事件注册给selector时，selector会给它们分配key值(可以简单理解为事件的标签), 当I/O事件完成后，会通过key值找到相应的管道，然后通过管道发送数据和接受数据等操作.</p>
<h4 id="数据缓冲区："><a href="#数据缓冲区：" class="headerlink" title="数据缓冲区："></a>数据缓冲区：</h4><p>通过bytebuffer， 提供了很多读写方法</p>
<ul>
<li>put</li>
<li>get</li>
</ul>
<h4 id="服务端：ServerSocketChannel"><a href="#服务端：ServerSocketChannel" class="headerlink" title="服务端：ServerSocketChannel"></a>服务端：ServerSocketChannel</h4><h4 id="客户端：SocketChannel"><a href="#客户端：SocketChannel" class="headerlink" title="客户端：SocketChannel"></a>客户端：SocketChannel</h4><h4 id="选择器：Selector"><a href="#选择器：Selector" class="headerlink" title="选择器：Selector"></a>选择器：Selector</h4><p>打开选择器：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Selector selector = Selector.open();</span><br></pre></td></tr></table></figure></p>
<h4 id="SelectionKey"><a href="#SelectionKey" class="headerlink" title="SelectionKey"></a>SelectionKey</h4><p>可以通过它来判断IO事件是否已经就绪，通过以下代码获得:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SelectionKey keys = Selector.selectedKeys();</span><br></pre></td></tr></table></figure></p>
<p>状态获取：<br>key.isAccptable() - 是否可以接受客户端的连接<br>key.isConnectionable() - 是否可以连接服务器<br>key.isReadable() - 是否可读<br>key.isWriteable() - 是否可写</p>
<h4 id="如何注册"><a href="#如何注册" class="headerlink" title="如何注册"></a>如何注册</h4><p>channel.regist(Selector, SelectionKey.OP_Write);<br>channel.regist(Selector, SelectionKey.OP_Read);<br>channel.regist(Selector, SelectionKey.OP_Connect);<br>channel.regist(Selector, SelectionKey.OP_Accept);</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://anshenzheng.github.io/2016/06/08/JMS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Annan An">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知乐园">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/06/08/JMS/" itemprop="url">JMS</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-06-08T12:39:57+08:00">2016-06-08</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/中间件/" itemprop="url" rel="index"><span itemprop="name">中间件</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2016/06/08/JMS/" class="leancloud_visitors" data-flag-title="JMS">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><h3 id="什么是JMS"><a href="#什么是JMS" class="headerlink" title="什么是JMS"></a>什么是JMS</h3><ul>
<li>JMS是Java Message Servie的缩写</li>
<li>它是一个用于在不同的客户端之间传递消息的Java消息的中间件应用接口</li>
<li>它是处理生产者消费者问题的一种实现</li>
<li>它也是一种消息标准，允许应用组件在J2EE平台创建，发送，接受和读取消息</li>
</ul>
<p>JMS和JDBC很像，Java只是提供了一个访问JMS服务器以及进行消息处理的API标准，它完全独立于中间件消息服务器，就像JDBC独立于Oracle/Mysql之类的数据库一样。</p>
<h3 id="JMS的消息模型"><a href="#JMS的消息模型" class="headerlink" title="JMS的消息模型"></a>JMS的消息模型</h3><ul>
<li><p>P2P 端到端模型<br>P2P模型的target是队列(Queue), 消息首先发送到队列中, 之后在从队列中发送给监听队列的客户端中。一个队列可以连接多个消息发送方和多个消息接收方, 但是一个消息只能发送给一个接受者。如果有多个接收方都在监听队列中的消息, 那么JMS消息的发送将基于FCFS(First Come, First Server)原则。如果没有接收方监听队列, 那么消息将一直保存在队列中, 直到有接收方连接到队列。<br><img src="https://github.com/Anshenzheng/ImageStore/blob/master/JMS%20P2P.PNG?raw=true" alt=""></p>
</li>
<li><p>Pub/Sub 发布订阅模型<br>Pub/Sub模型中，一个消息可以从一个应用发送给多个接收者, 此时的target是topic。消息首先被发送至topic中, 之后会发送给所有订阅了该topic的接收者。<br><img src="https://github.com/Anshenzheng/ImageStore/blob/master/JMS%20P2S.PNG?raw=true" alt=""></p>
</li>
</ul>
<h3 id="JMS的使用"><a href="#JMS的使用" class="headerlink" title="JMS的使用"></a>JMS的使用</h3><h4 id="JMS-API模块"><a href="#JMS-API模块" class="headerlink" title="JMS API模块"></a>JMS API模块</h4><p><img src="https://github.com/Anshenzheng/ImageStore/blob/master/JMS%20API%20Modules.PNG?raw=true" alt=""></p>
<ul>
<li><p>Administered Objects<br>Administered Objects是预配置的JMS对象, 它有系统管理员创建, 用于管理Connection Factory和Destination。</p>
</li>
<li><p>Connection Factories<br>客户端通过Connection Factory创建通JMS服务器之间的连接。JMS客户端会在JNDI命名空间中查找并创建连接, 通target之间建立连接之后, 就可以发送或者接收消息。</p>
</li>
</ul>
<p>代码示例<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QueueConnectionFactory factory = (QueueConnectionFactory)initialCxt.lookup(<span class="string">"primaryQCF"</span>);</span><br><span class="line">Queue puchaseQueue = (Queue)initialCxt.lookup(<span class="string">"Purchase_Queue"</span>);</span><br><span class="line">Queue returnQueue = (Queue)initialCtx.lookup(<span class="string">"Return_Queue"</span>);</span><br></pre></td></tr></table></figure></p>
<ul>
<li>Destination<br>Destination指明消息发送的目标, 或者消息的来源, 可以是Queue也可以是Topic。</li>
</ul>
<p>创建Queue代码示例:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">QueueSession session = con.createQueueSession(<span class="keyword">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">Queue queue = (Queue)ctx.lookup(<span class="string">"myQueue"</span>);</span><br><span class="line">QueueReceiver receiver = session.createReceiver(queue);</span><br></pre></td></tr></table></figure></p>
<p>创建Topic代码示例:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TopicSession session = con.createTopicSession(<span class="keyword">false</span>, Session.AUTO_ACKNOWLEDGE);</span><br><span class="line">Topic topic = (Topic)ctx.lookup(<span class="string">"myTopic"</span>);</span><br><span class="line">TopicSubscriber receiver = session.createSubscriber(topic);</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>Connection<br>Connection用于连接JMS服务器。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建连接</span></span><br><span class="line">Connection connection = connectionFactory.createConnection();</span><br><span class="line"><span class="comment">//关闭连接</span></span><br><span class="line">connection.close();</span><br></pre></td></tr></table></figure>
</li>
<li><p>Sessions<br>Session是一个单线程上下文对象, 用于创建生产者或者消费者。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建Session</span></span><br><span class="line">Session session = connection.createSession(<span class="keyword">false</span>,Session.AUTO_ACKNOWLEDGE);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Message Producer<br>消息生产者由Session创建，用于发送消息到Destination。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MessageProducer producer = session.createProducer(dest);</span><br><span class="line">MessageProducer producer2 = session.createProducer(queue);</span><br><span class="line">MessageProducer producer3 = session.createProducer(topic);</span><br><span class="line"></span><br><span class="line">producer.send(message);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Message Consumers<br>消息消费者也是由Session创建, 用于从Destination接收消息。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MessageConsummer consummer = session.createConsummer(dest);</span><br><span class="line">MessageConsummer consummer2 = session.createConsummer(queue);</span><br><span class="line">MessageConsummer consummer3 = session.createConsummer(topic);</span><br><span class="line"></span><br><span class="line">consummer.send(message);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Message Listeners<br>消息监听器是默认的事件处理器, 它是MessageListener接口的实现, 该接口中包含的onMessage方法用于处理消息发送成功之后的处理逻辑。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Listener myListener = <span class="keyword">new</span> Listener();</span><br><span class="line">Consummer.setMessageListener(myListener);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="JMS消息结构"><a href="#JMS消息结构" class="headerlink" title="JMS消息结构"></a>JMS消息结构</h3><p>JMS客户端通过JMS消息同JMS服务器进行交互, JMS消息包括以下3部分:</p>
<h4 id="Message-Header-消息头"><a href="#Message-Header-消息头" class="headerlink" title="Message Header 消息头"></a>Message Header 消息头</h4><p>消息头中预定义了一些字段用于JMS客户端和JMS服务器之间的识别和消息传送。</p>
<p>消息头：</p>
<ul>
<li>JMSDestination</li>
<li>JMSDeliveryMode</li>
<li>JMSMessageID</li>
<li>JMSTimestamp</li>
<li>JMSCorrelationID</li>
<li>JMSReplyTo</li>
<li>JMSRedelivered</li>
<li>JMSType</li>
<li>JMSExpiration</li>
<li>JMSPriority</li>
</ul>
<h4 id="Message-Property-消息属性"><a href="#Message-Property-消息属性" class="headerlink" title="Message Property 消息属性"></a>Message Property 消息属性</h4><p>消息属性可以由用户自定义，主要是提供给应用程序使用, 可以用于消息过滤。<br>JMS API提供的也有一些标准的属性信息。</p>
<h4 id="Message-Body-消息体"><a href="#Message-Body-消息体" class="headerlink" title="Message Body 消息体"></a>Message Body 消息体</h4><p>JMS提供的消息体有以下5种：</p>
<ul>
<li><p>Text Message<br>javax.jms.TextMessage</p>
</li>
<li><p>Object Message<br>javax.jms.ObjectMessage</p>
</li>
<li><p>Bytes Message<br>javax.jms.BytesMessage</p>
</li>
<li><p>Stream Message<br>javax.jms.streamMessage</p>
</li>
<li><p>Map Message<br>javax.jms.MapMessage</p>
</li>
</ul>
<h4 id="JMS的使用示例"><a href="#JMS的使用示例" class="headerlink" title="JMS的使用示例"></a>JMS的使用示例</h4><p><a href="http://www.cnblogs.com/chenpi/p/5565618.html" target="_blank" rel="noopener">Tomcat + JNDI + ActiveMQ P2P</a></p>
<p><a href="http://www.cnblogs.com/chenpi/p/5566983.html" target="_blank" rel="noopener">Tomcat + JNDI + ActiveMQ Pub/Sub</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://anshenzheng.github.io/2015/07/29/应用服务器集群实现方式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Annan An">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知乐园">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/07/29/应用服务器集群实现方式/" itemprop="url">应用服务器集群几种基本实现方式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-29T14:18:35+08:00">2015-07-29</time>
            

            
            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/07/29/应用服务器集群实现方式/" class="leancloud_visitors" data-flag-title="应用服务器集群几种基本实现方式">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><p>负载均衡是网站必不可少的基础技术手段，不但可以实现网站的伸缩性，还可以改善网站的可用性。<br><img src="/images/负载均衡0.png" alt=""><br>负载均衡的实现技术也有多种多样，从硬件到软件，从商业产品到开源软件，多不胜数，主要实现负载均衡的基础技术有以下几种：</p>
<h3 id="HTTP重定向负载均衡"><a href="#HTTP重定向负载均衡" class="headerlink" title="HTTP重定向负载均衡"></a>HTTP重定向负载均衡</h3><p>HTTP重定向服务器时一台普通的应用服务器，唯一的功能就是根据用户的HTTP请求计算出一台真实的Web服务器地址，并将该Web服务器地址写入HTTP重定向响应中(响应状态码302)返回给用户浏览器，然后浏览器自动重新请求实际的物理服务器IP地址，从而完成访问。</p>
<p>这种实现方案优点是比较简单，缺点是浏览器需要两次请求服务器才能完成一次访问，性能比较差。重定向服务器自身的处理能力有可能成为瓶颈，整个集群的伸缩性规模有限。而且使用HTTP302响应吗重定向有可能使搜索引擎判断为SEO作弊，降低搜索排名。</p>
<h3 id="DNS域名解析负载均衡"><a href="#DNS域名解析负载均衡" class="headerlink" title="DNS域名解析负载均衡"></a>DNS域名解析负载均衡</h3><p>这是利用DNS处理域名解析请求的同时进行负载均衡处理的一种方案。在DNS服务器中对指定域名配置多个ip地址，每次域名解析请求都会根据负载均衡算法计算出一个不同的IP地址，这样配置的多个服务器就构成一个集群，并且可以实现负载均衡。</p>
<p>DNS域名解析负载均衡的优点是将负载均衡的工作转交给DNS，省掉了网站管理维护负载均衡服务器的麻烦，同时许多DNS还支持基于地理位置的域名解析，即会将域名解析成距离用户地理最近的一个服务器地址，这样可以加速用户访问速度，改善性能。<br>DNS域名解析负载均衡的缺点是目前的DNS是多级解析，每一级DNS都可能缓存，当下线了某台服务器后，即使修改了DNS中的记录，要使其生效也需要很长时间，这段时间，DNS依然会将域名解析道已经下线的服务器，从而导致用户访问失败。而且DNS负载均衡的控制权在域名服务商那里，网站无法对其做更多的改善和更强大的管理。</p>
<p>实际上，很多大型网站总是部分使用DNS域名解析，利用域名解析作为第一级负载均衡手段，即域名解析得到的一组服务器并不是实际提供Web服务的物理服务器，而是同样提供负载均衡服务的内部服务器，这组内部负载均衡服务器再进行负载均衡，将请求分发到真实的Web服务器上。</p>
<h3 id="反向代理负载均衡"><a href="#反向代理负载均衡" class="headerlink" title="反向代理负载均衡"></a>反向代理负载均衡</h3><p>反向代理服务器位于服务器端，正好是负载均衡服务器的位置，所以大多数反向代理服务器同时提供负载均衡的功能，管理一组Web服务器，将请求根据负载均衡算法转发到不同的Web服务器上，Web服务器处理完成的响应请求也需要通过反向代理服务器返回给用户。由于Web服务器不直接对外提供访问，因此Web服务器不需要使用外部IP地址，而反向代理则需要配置双网卡和内部外部两套IP地址。</p>
<p>反向代理负载均衡的优点是负载均衡和反向代理服务器功能集成在一起，部署简单。缺点时反向代理服务器是所有请求和响应的中转站，性能可能会成为瓶颈。</p>
<h3 id="IP负载均衡"><a href="#IP负载均衡" class="headerlink" title="IP负载均衡"></a>IP负载均衡</h3><p>IP负载均衡的原理是在网络层通过修改请求目标地址进行负载均衡。用户请求数据包达到负载均衡服务器之后，负载均衡服务器在操作系统内核进程获取网络数据包，根据负载均衡算法计算得到真实的Web服务器IP地址，然后将数据目的IP地址修改为真实的Web服务器地址，不需要通过用户进程处理。真实Web应用服务器处理完成后，响应数据包回到负载均衡服务器，负载均衡服务器再将数据包源地址修改为自身的IP地址发送给用户浏览器。</p>
<p>这里的关键在于真实物理Web服务器响应数据如何返回给负载均衡服务器。一种方案是负载均衡服务器修改目的IP地址的同时修改源地址，将数据包源地址设为自身的IP地址，即源地址转换(SNAT), 这样Web服务器的响应会再回到负载均衡服务器；另一种方案是负载均衡服务器同时作为真实物理服务器集群的网关服务器，这样所有的响应数据都会达到负载均衡服务器。</p>
<p>IP负载均衡在内核进程完成数据分发，比反向代理负载均衡有更好的处理性能。但是由于所有请求响应都需要经过负载均衡服务器，集群的最大响应数据吞吐量不得不受制于负载均衡服务器网卡带宽。对于提供下载服务或者是视频服务等需要传输大量数据的网站而言，难以满足需求。</p>
<h3 id="数据链路层负载均衡"><a href="#数据链路层负载均衡" class="headerlink" title="数据链路层负载均衡"></a>数据链路层负载均衡</h3><p>数据链路层负载均衡是指在通信协议的数据链路层修改MAC地址进行负载均衡。<br>负载均衡数据分发过程中不修改IP地址，之修改MAC地址，通过配置真实物理服务器集群所有机器虚拟IP和负载均衡服务器IP地址一致，从而达到不修改数据包的源地址和目的地址就可以进行数据分发的目的，由于实际处理请求的真实物理服务器IP地址和数据请求的目的IP一致，不需要经过负载均衡服务器进行地址转换，就可以把响应数据包直接返回给用户浏览器，避免负载均衡服务器网卡带宽成为瓶颈。这种负载均衡方式又称为直接路由方式。</p>
<p>这种方式是目前大型网站使用最广的一种负载均衡手段， Linux平台上最好的链路层负载均衡开源产品时LVS (Linux Virtual Server).</p>
<p>参考：<br>《大型网站技术架构》 李智慧 著</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://anshenzheng.github.io/2015/07/27/Web前端性能优化/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Annan An">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="知乐园">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/07/27/Web前端性能优化/" itemprop="url">Web前端性能优化</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-27T19:45:57+08:00">2015-07-27</time>
            

            
            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/07/27/Web前端性能优化/" class="leancloud_visitors" data-flag-title="Web前端性能优化">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数：</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <script src="/assets/js/APlayer.min.js"> </script><p>一般来说，Web前端指网站业务逻辑之前的部分，包括浏览器加载，网站视图模型，图片服务，CDN服务等，主要的优化手段有以下几种：</p>
<h3 id="减少http请求"><a href="#减少http请求" class="headerlink" title="减少http请求"></a>减少http请求</h3><p>HTTP协议是无状态的应用层协议，意味着每次HTTP请求都需要建立通信链路，进行数据传输，而在服务端，每个HTTP请求都需要启动独立的线程去处理。这些通信和服务的开销都很昂贵，减少了HTTP请求的数目可以有效提高访问性能。</p>
<p>减少HTTP请求的主要手段：</p>
<ul>
<li>合并CSS</li>
<li>合并Javascript</li>
<li>合并图片</li>
</ul>
<h3 id="使用浏览器缓存"><a href="#使用浏览器缓存" class="headerlink" title="使用浏览器缓存"></a>使用浏览器缓存</h3><p>对于一个网站而言，CSS，Javascript，图标等静态资源文件的更新频率都比较低，但这些文件有几乎是每次页面请求都需要的，所以把这些静态资源缓存在浏览器中可以很好的改善网站的性能。<br>通过设置HTTP请求头中的Cache-Control和Expires属性，可以设定浏览器缓存，缓存的时间可以是数天也可以是几个月。<br>在有些时候静态资源文件变化需要及时应用到客户端浏览器，在这种情况下，可以通过改变文件命名来实现。</p>
<blockquote>
<p>大量使用浏览器缓存策略的网站在更新静态资源时，应该用批量更新的方法，并有时间间隔，以免用户浏览器突然大量缓存失效，大量用户集中更新缓存，可能会造成服务器负载骤增及网络堵塞的状况。</p>
</blockquote>
<h3 id="服务端启用压缩"><a href="#服务端启用压缩" class="headerlink" title="服务端启用压缩"></a>服务端启用压缩</h3><p>在服务器端对文件进行压缩，在浏览器端对文件解压缩，可用有效减少通信传输的信息量。一般来说，启用GZIP等压缩方式可以对HTML，CSS，Javascript等文本文件达到80%的压缩率。</p>
<blockquote>
<p>压缩对服务器和浏览器产生一定的压力，在通信带宽良好，而服务器资源不足的情况下要权衡考虑。</p>
</blockquote>
<h3 id="CSS引用放在页面最上方，Javascript引用放在页面最下方"><a href="#CSS引用放在页面最上方，Javascript引用放在页面最下方" class="headerlink" title="CSS引用放在页面最上方，Javascript引用放在页面最下方"></a>CSS引用放在页面最上方，Javascript引用放在页面最下方</h3><p>浏览器会在加载完全部CSS之后才会对整个页面进行渲染，因此最好的做法是把CSS引用放在页面最上方，让浏览器尽快下载完CSS文件。Javascript则相反，浏览器在加载Javascript之后立即执行，有可能会阻塞真个页面，造成页面显示缓慢。</p>
<blockquote>
<p>如果页面解析时需要用到Javascript，这时放在页面底部就不合适了。</p>
</blockquote>
<h3 id="减少Cookie传输"><a href="#减少Cookie传输" class="headerlink" title="减少Cookie传输"></a>减少Cookie传输</h3><p>Cookie包含在每次请求和响应中，太大的Cookie会严重影响数据传输，因此哪些数据需要写入Cookie需要慎重考虑，尽量减少Cookie中传输的数据量。<br>对于一些静态资源的访问，如CSS，Javascript等，发送Cookie是没有意义的，可以考虑静态资源使用独立域名访问，减少Cookie传输的次数。</p>
<h3 id="CDN加速"><a href="#CDN加速" class="headerlink" title="CDN加速"></a>CDN加速</h3><p>CDN(Content Distribute Network, 内容分发网络)的本质仍然是一个缓存，而且是将数据缓存在离用户最近的地方，使用户以最快速度获取数据。<br>CDN可以缓存一般的静态资源，如图片，文件，CSS，Script脚本及静态网页等，这些都是访问频度比较高的文件，缓存在CDN可以极大改善网页的打开速度。</p>
<h3 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h3><p>传统代理服务器位于浏览器一侧，代理浏览器将HTTP请求发送到互联网上，而反向代理服务器位于网站机房的一侧，代理网站Web服务器接收HTTP请求。<br>来自互联网的请求必须经过代理服务器，相当于在Web服务器和外部网络之间建立了一个屏障，可以保护Web服务器防御外部的网络攻击，也可以配置缓存功能加速Web请求，而且还可以通过反向代理实现负载均衡的功能。</p>
<p>参考：<br>《大型网站技术架构》 李智慧 著</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="Annan An" />
            
              <p class="site-author-name" itemprop="name">Annan An</p>
              <p class="site-description motion-element" itemprop="description">千里之行, 始于足下</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">20</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">8</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">38</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Annan An</span>

  

  
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a> v6.0.6</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.6"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.6"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.6"></script>



  



	





  





  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("Jco0PO4JGXXJJB1mvmQIOyus-gzGzoHsz", "5K4RnHGh9iAxmU9OuEJFsWxv");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            
            counter.save(null, {
              success: function(counter) {
                
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(counter.get('time'));
                
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            
              var newcounter = new Counter();
              /* Set ACL */
              var acl = new AV.ACL();
              acl.setPublicReadAccess(true);
              acl.setPublicWriteAccess(true);
              newcounter.setACL(acl);
              /* End Set ACL */
              newcounter.set("title", title);
              newcounter.set("url", url);
              newcounter.set("time", 1);
              newcounter.save(null, {
                success: function(newcounter) {
                  var $element = $(document.getElementById(url));
                  $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
                },
                error: function(newcounter, error) {
                  console.log('Failed to create');
                }
              });
            
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  
  

  

  

  

  

  <script type="text/javascript" src="/js/src/love.js"></script>
</body>
</html>
